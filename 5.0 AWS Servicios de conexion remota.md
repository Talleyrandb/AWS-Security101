# Bastion Hosts 
Un host bastión es un servidor expuesto a Internet que actúa como un punto de entrada seguro para acceder a instancias en una red privada. Este enfoque es fundamental para mejorar la seguridad, ya que permite controlar y restringir el acceso a recursos sensibles en una Virtual Private Cloud (VPC).

**¿Cómo Funciona un Host Bastión?**

### Arquitectura Básica

1. Ubicación: El host bastión se despliega en una subred pública de la VPC, mientras que las instancias a las que se desea acceder se encuentran en subredes privadas. Esto permite que el host bastión sea accesible desde Internet, pero las instancias privadas no lo son.
2. Conexiones Seguras: Los usuarios se conectan al host bastión utilizando SSH (Secure Shell) o RDP (Remote Desktop Protocol) dependiendo de si están utilizando instancias de Linux o Windows, respectivamente. Esta conexión se realiza a través de un puerto específico (normalmente el puerto 22 para SSH y el puerto 3389 para RDP). 
3. Grupos de Seguridad: Es crucial configurar adecuadamente los grupos de seguridad del host bastión. Se deben permitir las conexiones entrantes desde direcciones IP específicas (por ejemplo, la dirección IP pública del usuario) y permitir el tráfico saliente hacia las subredes privadas.
### Proceso de Conexión

1. Autenticación: Antes de conectarse al host bastión, el usuario debe tener un par de claves SSH o credenciales RDP. AWS Identity and Access Management (IAM) controla los permisos de acceso.
2. Establecimiento de la Conexión:
*  Para conexiones SSH, el usuario ejecuta un comando como:

```bash
ssh -i /path/to/key.pem ec2-user@bastion-public-ip
```

*  Una vez conectado al host bastión, el usuario puede iniciar sesiones adicionales a las instancias en la subred privada utilizando comandos SSH o RDP.

### Seguridad Adicional

1. Sin Puertos Abiertos: Un patrón recomendado es no tener puertos de entrada abiertos en las instancias privadas, lo que minimiza la superficie de ataque. El acceso se controla completamente a través del host bastión.
2. Uso de Session Manager: AWS ofrece herramientas como Session Manager que permiten conexiones sin necesidad de abrir puertos adicionales o gestionar claves SSH a largo plazo. Cada sesión puede generar claves temporales para mayor seguridad.

### Implementación y Escalabilidad

1. Automatización: La implementación del host bastión puede ser automatizada utilizando herramientas como AWS CloudFormation o Terraform. Esto permite la creación rápida y escalable de múltiples hosts bastión si es necesario 
2. Mantenimiento: Después de completar tareas administrativas, es posible detener el host bastión para reducir costos y aumentar la seguridad, ya que no estará activo continuamente.

**Bastion host ejemplo:**

![imagen](https://github.com/user-attachments/assets/6a557bd1-4a27-4d21-9d9a-f7ebc4c77215)


# AWS Site-to-Site VPN

AWS Site-to-Site VPN crea un enlace seguro en Internet mediante el uso de túneles de seguridad IP (IPsec), permitiendo que los datos fluyan entre su infraestructura local On-premises y Virtual Private Cloud (VPC) en AWS. Este servicio es ideal para empresas que desean extender sus redes On-premises a la nube de AWS, facilitando la comunicación segura y eficiente entre ambas partes.

## Componentes Clave

1. VPN Conexión: Es la conexión segura entre su red local y su VPC.
2. VPN Túnel: Cada conexión incluye dos túneles para garantizar alta disponibilidad; si uno falla, el tráfico se redirige automáticamente al otro.
3. Route Table: Una tabla que contiene las reglas que determinan cómo se enruta el tráfico dentro de una VPC.
4. Route Propagation: Proceso mediante el cual las rutas aprendidas a través de una conexión VPN se añaden automáticamente a las tablas de rutas asociadas. **Importante habilite Route Propagation para la Virtual Private Gateway en la route table que esta asociada con su subred**
5. Customer Gateway: Representa el dispositivo en su red local que se conecta a AWS. Esto puede ser un hardware o software específico.
6. Virtual Private Gateway: Es el punto final de AWS para la conexión VPN, que se asocia con una VPC específic.

## Customer Gateway (CGW)
El Customer Gateway es un recurso que representa el dispositivo de puerta de enlace en su red local. Este dispositivo puede ser un hardware físico o una aplicación de software que se configura para interactuar con la VPN de AWS.

*  Configuración del Dispositivo: El CGW debe ser configurado manualmente para trabajar con la conexión VPN. Esto incluye la configuración de los túneles y el intercambio de claves necesarias para establecer la conexión segura.
*  Dirección IP Estática: El CGW necesita tener una dirección IP pública estática, que se utiliza para establecer la conexión con el VGW en AWS. Si está detrás de un dispositivo NAT, se debe configurar el NAT para permitir el tráfico adecuado.
*  Autenticación y Seguridad: Puede utilizar certificados privados a través de AWS Private Certificate Authority para autenticar la conexión, lo que añade una capa adicional de seguridad. 
*  Túneles VPN: Cada conexión VPN incluye dos túneles para alta disponibilidad. Si uno falla, el otro puede asumir automáticamente la carga, asegurando así que la conexión permanezca activa

## Virtual Private Gateway (VGW)
El Virtual Private Gateway es el concentrador VPN del lado de AWS para la conexion VPN. VGW es creado y atado a su VPC desde la cual usted quiere crear su VPN site-to-side. Actúa como el punto final en la nube para las conexiones VPN. es posible personalizar sii VGW con ASN (Autonomous System Number). Sus características son las siguientes:

*  Conexión a VPC: El VGW se adjunta a una VPC específica y permite que los recursos dentro de esa VPC accedan a la red local a través de la VPN.
*  Configuración del ASN: Al crear un VGW, puede especificar un número de sistema autónomo (ASN) privado para BGP. Si no se especifica, se asigna un ASN predeterminado. Este ASN es crucial para la configuración del enrutamiento dinámico entre su red local y AWS.
*  Soporte para IPv4 e IPv6: El VGW puede manejar tráfico IPv4, pero no soporta tráfico IPv6 directamente. Sin embargo, si usa un Transit Gateway, puede gestionar tráfico IPv6.
*  Si necesita hacer ping a su intancia EC2 desde el on-premises, asegurese de adicionar el protocolo ICMP en el trafico Inbound del security group.

**AWS site-to-site Ejemplo**

![imagen](https://docs.aws.amazon.com/images/vpn/latest/s2svpn/images/cgw-high-level.png)


# AWS VPN CloudHub

# AWS Client VPN

# VPC Peering

# VPC Endpoints

# AWS PrivateLink

# Transit Gateway


# 
